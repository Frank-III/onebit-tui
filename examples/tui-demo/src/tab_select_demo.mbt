///|
/// Demo showcasing the TabSelect widget
fn main_tab_select_demo() -> Unit {
  let app = @core.App::init()
  match app {
    None => println("Failed to initialize app")
    Some(app) => {
      // Tab data
      let tabs = ["Dashboard", "Settings", "Profile", "Notifications", "Help"]
      let selected_tab = Ref::new(0)
      
      // Content for each tab
      fn get_tab_content(index : Int) -> Array[@view.View] {
        match index {
          0 => [
            @view.View::text("ðŸ“Š Dashboard Content", color=@core.Color::Cyan),
            @view.View::text("", color=@core.Color::White),  // Empty line
            @view.View::text("â€¢ Total Users: 1,234", color=@core.Color::White),
            @view.View::text("â€¢ Active Sessions: 42", color=@core.Color::Green),
            @view.View::text("â€¢ CPU Usage: 23%", color=@core.Color::Yellow),
            @view.View::text("â€¢ Memory: 4.2 GB / 8 GB", color=@core.Color::White),
          ]
          1 => [
            @view.View::text("âš™ï¸ Settings", color=@core.Color::Cyan),
            @view.View::text("", color=@core.Color::White),
            @view.View::text("[ ] Dark Mode", color=@core.Color::White),
            @view.View::text("[âœ“] Auto-save", color=@core.Color::Green),
            @view.View::text("[âœ“] Show notifications", color=@core.Color::Green),
            @view.View::text("[ ] Verbose logging", color=@core.Color::White),
          ]
          2 => [
            @view.View::text("ðŸ‘¤ User Profile", color=@core.Color::Cyan),
            @view.View::text("", color=@core.Color::White),
            @view.View::text("Name: John Doe", color=@core.Color::White),
            @view.View::text("Email: john@example.com", color=@core.Color::White),
            @view.View::text("Role: Administrator", color=@core.Color::Yellow),
            @view.View::text("Last Login: 2 hours ago", color=@core.Color::Gray),
          ]
          3 => [
            @view.View::text("ðŸ”” Notifications", color=@core.Color::Cyan),
            @view.View::text("", color=@core.Color::White),
            @view.View::text("â€¢ System update available", color=@core.Color::Yellow),
            @view.View::text("â€¢ Backup completed successfully", color=@core.Color::Green),
            @view.View::text("â€¢ New user registered", color=@core.Color::White),
            @view.View::text("â€¢ Disk space warning (85% used)", color=@core.Color::Red),
          ]
          _ => [
            @view.View::text("â“ Help & Documentation", color=@core.Color::Cyan),
            @view.View::text("", color=@core.Color::White),
            @view.View::text("Keyboard Shortcuts:", color=@core.Color::Yellow),
            @view.View::text("â€¢ Arrow Keys: Navigate tabs", color=@core.Color::White),
            @view.View::text("â€¢ Home/End: First/Last tab", color=@core.Color::White),
            @view.View::text("â€¢ 1-5: Quick select tab", color=@core.Color::White),
            @view.View::text("â€¢ Tab: Focus next element", color=@core.Color::White),
            @view.View::text("â€¢ q: Quit application", color=@core.Color::White),
          ]
        }
      }
      
      // Create tab select widget
      let tab_select = @widget.TabSelect::new(
        tabs,
        fn(t) { t },
        selected=selected_tab
      )
        .with_id(2000)
        .on_change(fn(index, tab) {
          println("Tab changed to: \{tab} (index: \{index})")
        })
      
      fn build_ui() -> @view.View {
        // Get content for selected tab
        let content_views = get_tab_content(selected_tab.val)
        
        @view.View::container_views([
          // Title
          @view.View::text("TabSelect Widget Demo", color=@core.Color::Yellow)
            .padding(1.0),
          
          // Tab selector
          tab_select.render(),
          
          // Content area with border
          @view.View::container_views(content_views)
            .direction(@view.Direction::Column)
            .spacing(0.5)
            .padding(2.0)
            .border(@view.BorderStyle::Single, color=@core.Color::White)
            .height(12.0)  // Fixed height for content area
            .width(50.0),  // Fixed width
          
          // Status bar
          @view.View::text("Tab \{selected_tab.val + 1} of \{tabs.length()} | Press arrows to navigate, 1-5 for quick select, 'q' to quit", 
                          color=@core.Color::Gray)
            .margin_top(1.0),
        ])
          .direction(@view.Direction::Column)
          .spacing(1.0)
          .padding(2.0)
      }
      
      // Run event loop
      @runtime.run_event_loop(app, build_ui, on_global_event=fn(event) {
        match event {
          @ffi.InputEvent::Key(@ffi.KeyEvent::Char(113)) => false  // 'q' to quit
          @ffi.InputEvent::Key(@ffi.KeyEvent::Escape) => false
          _ => true
        }
      })
      
      app.cleanup()
    }
  }
}