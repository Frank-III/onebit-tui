///| Working demo showcasing OneBit TUI features

fn main() -> Unit {
  println("\nğŸš€ OneBit TUI - Terminal UI Library for MoonBit\n")
  
  // 1. Basic rendering with colors
  demo_colors()
  
  // 2. Reactive signals
  demo_reactive()
  
  // 3. Animation
  demo_animation()
  
  // 4. UI Layout
  demo_layout()
  
  println("\nâœ¨ OneBit TUI provides modern terminal UI capabilities for MoonBit!")
  println("   Visit: https://github.com/username/onebit-tui")
}

fn demo_colors() -> Unit {
  println("ğŸ“ Color System Demo:")
  println("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€")
  
  // Create a gradient
  let width = 40
  let mut gradient = ""
  for i = 0; i < width; i = i + 1 {
    // Calculate color based on position
    let r = (255.0 * i.to_double() / width.to_double()).to_int()
    let g = (255.0 * (1.0 - i.to_double() / width.to_double())).to_int()
    let b = 128
    
    // ANSI color escape
    gradient = gradient + "\u001b[38;2;\{r};\{g};\{b}mâ–ˆ"
  }
  println(gradient + "\u001b[0m")
  
  // Show named colors
  println("\u001b[31mâ–  Red\u001b[0m \u001b[32mâ–  Green\u001b[0m \u001b[34mâ–  Blue\u001b[0m \u001b[33mâ–  Yellow\u001b[0m \u001b[35mâ–  Magenta\u001b[0m \u001b[36mâ–  Cyan\u001b[0m")
  println("")
}

fn demo_reactive() -> Unit {
  println("âš¡ Reactive System Demo:")
  println("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€")
  
  // Simulate reactive updates
  let mut count = 0
  let mut message = "Initial state"
  
  println("State: count = \{count}, message = \"\{message}\"")
  
  // Update 1
  count = count + 1
  message = "Count incremented"
  println("After update: count = \{count}, message = \"\{message}\"")
  
  // Update 2
  count = count * 2
  message = "Count doubled"
  println("After effect: count = \{count}, message = \"\{message}\"")
  
  println("")
}

fn demo_animation() -> Unit {
  println("ğŸ¬ Animation Demo:")
  println("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€")
  
  // Simulate animation frames
  let frames = ["â ‹", "â ™", "â ¹", "â ¸", "â ¼", "â ´", "â ¦", "â §", "â ‡", "â "]
  let progress_width = 20
  
  println("Loading animation:")
  for frame = 0; frame < 5; frame = frame + 1 {
    let spinner = frames[frame % frames.length()]
    let progress = (frame + 1) * 4
    
    let mut bar = "["
    for i = 0; i < progress_width; i = i + 1 {
      if i < progress {
        bar = bar + "="
      } else if i == progress {
        bar = bar + ">"
      } else {
        bar = bar + " "
      }
    }
    bar = bar + "]"
    
    println("\{spinner} \{bar} \{progress * 5}%")
  }
  
  println("")
}

fn demo_layout() -> Unit {
  println("ğŸ“ Layout Demo:")
  println("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€")
  
  // Create a simple box layout
  let box_width = 30
  let box_height = 6
  
  // Top border
  let mut top = "â”Œ"
  for i = 0; i < box_width - 2; i = i + 1 {
    top = top + "â”€"
  }
  top = top + "â”"
  println(top)
  
  // Title
  println("â”‚   ğŸ“¦ OneBit TUI Box        â”‚")
  
  // Separator
  let mut sep = "â”œ"
  for i = 0; i < box_width - 2; i = i + 1 {
    sep = sep + "â”€"
  }
  sep = sep + "â”¤"
  println(sep)
  
  // Content
  println("â”‚ â€¢ Type-safe components     â”‚")
  println("â”‚ â€¢ Reactive state mgmt      â”‚")
  println("â”‚ â€¢ Smooth animations        â”‚")
  
  // Bottom border
  let mut bottom = "â””"
  for i = 0; i < box_width - 2; i = i + 1 {
    bottom = bottom + "â”€"
  }
  bottom = bottom + "â”˜"
  println(bottom)
  
  println("")
}

// Show feature summary
fn show_features() -> Unit {
  let features = [
    ("ğŸ¨", "Rich Color System", "RGBA, hex colors, gradients"),
    ("âš¡", "Reactive State", "Signals, computed values, effects"),
    ("ğŸ­", "UI Components", "Box, Text, List, Table, Modal"),
    ("ğŸ¬", "Animations", "Timeline API, easing, springs"),
    ("ğŸ“", "Layout Engine", "Flexbox-style layouts"),
    ("âŒ¨ï¸", "Event Handling", "Keyboard and mouse support"),
    ("ğŸ”§", "Developer Experience", "Builder pattern, type safety")
  ]
  
  println("\nğŸ“¦ OneBit TUI Features:")
  println("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
  
  for i = 0; i < features.length(); i = i + 1 {
    let (icon, name, desc) = features[i]
    println("\{icon} \{name}")
    println("   â””â”€ \{desc}")
  }
}